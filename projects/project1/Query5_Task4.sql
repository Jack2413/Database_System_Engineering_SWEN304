select distinct tempg.bankname,tempg.city,security,numofaccount from (select bankname,city,security from (select bankname,city,security from banks where (bankname,city) not in (select bankname,city from robberies)) as tempf natural join plans) as tempg left join (select bankname,city,count(robberid) as numOfAccount from hasaccounts group by (bankname,city)) as hastemp on (tempg.bankname,tempg.city)=(hastemp.bankname,hastemp.city) order by numofaccount DESC;